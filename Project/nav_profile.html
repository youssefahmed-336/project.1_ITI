<!doctype html>
<html lang="ar" dir="rtl">
  <head>
    <head>
      <title>Home</title>
      <link
        rel="icon"
        type="image/png"
        href="https://cdn-icons-png.flaticon.com/512/25/25694.png"
      />
    </head>
    <meta charset="UTF-8" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />

    <style>
      .profile-dropdown {
        position: relative;
        display: inline-block;
        font-family: "Segoe UI", Tahoma, sans-serif;
      }

      .profile-icon {
        cursor: pointer;
        width: 45px;
        height: 45px;
      }

      .profile-icon img {
        width: 100%;
        height: 100%;
        border-radius: 50%;
      }

      .dropdown-list {
        position: absolute;
        top: 55px;
        right: 0;
        background: white;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
        border-radius: 8px;
        width: 220px;
        display: none;
        list-style: none;
        padding: 8px 0;
        z-index: 1000;
        direction: ltr;
      }

      .dropdown-list.active {
        display: block;
      }

      .dropdown-list li a {
        padding: 12px 20px;
        display: flex;
        align-items: center;
        text-decoration: none;
        color: #444;
        transition: background 0.2s;
      }

      .dropdown-list li a:hover {
        background-color: #f8f9fa;
      }

      .dropdown-list li a i {
        width: 25px;
        font-size: 18px;
        margin-right: 15px;
        color: #666;
      }

      .dropdown-list li a span {
        font-size: 16px;
        font-weight: 500;
        letter-spacing: 0.5px;
      }

      .divider {
        border: 0;
        border-top: 1px solid #eee;
        margin: 5px 0;
      }
    </style>
  </head>
  <body>
    <nav class="navbar">
      <div class="profile-dropdown">
        <div class="profile-icon" onclick="toggleMenu()">
          <img src="images/profile.png" alt="User" class="rounded-circle" id="navProfileImg" />
        </div>

        <ul class="dropdown-list" id="dropdownMenu">
          <li>
            <a href="Profile.html">
              <i class="fa-solid fa-user"></i>
              <span>Profile</span>
            </a>
          </li>
          <hr class="divider" />
          <li>
            <a href="#" class="product">
              <i class="fa-solid fa-box-open"></i>
              <span>Product</span>
            </a>
          </li>

          <hr class="divider" />

          <li>
            <a href="#" class="categories">
              <i class="fa-solid fa-layer-group"></i>
              <span>categories</span>
            </a>
          </li>
          <hr class="divider" />

          <li>
            <a href="#" class="logout">
              <i class="fa-solid fa-right-from-bracket"></i>
              <span>Log out</span>
            </a>
          </li>
        </ul>
      </div>
    </nav>
    <script>
      function toggleMenu() {
        const menu = document.getElementById("dropdownMenu");
        menu.classList.toggle("active");
      }

      (function initNavPhoto() {
        const DEFAULT_PHOTO = "images/profile.png";
        const USERS_KEY = "eshop_users";
        const CURRENT_USER_KEY = "currentUser";

        let users = [];
        try {
          users = JSON.parse(localStorage.getItem(USERS_KEY) || "[]");
        } catch {
          users = [];
        }

        let currentUser = null;
        const raw = localStorage.getItem(CURRENT_USER_KEY);
        if (raw) {
          try {
            const parsed = JSON.parse(raw);
            if (parsed && typeof parsed === "object") {
              if (parsed.id != null) {
                currentUser = users.find((u) => u.id === parsed.id) || null;
              }
              if (!currentUser && parsed.username) {
                currentUser = users.find((u) => u.username === parsed.username) || null;
              }
              if (!currentUser && parsed.email) {
                currentUser = users.find((u) => u.email === parsed.email) || null;
              }
            }
          } catch {
            currentUser = users.find((u) => u.username === raw || u.email === raw) || null;
          }
        }

        const img = document.getElementById("navProfileImg");
        if (img) {
          img.src = currentUser?.photo || DEFAULT_PHOTO;
        }
      })();
    </script>
  </body>
</html>

